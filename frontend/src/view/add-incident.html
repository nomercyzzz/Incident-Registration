<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Добавление происшествия</title>
    <link rel="stylesheet" href="../styles/add-incident.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app" class="page-wrapper">
        <header class="header">
            <div class="header-left">
                <div class="logo-wrapper">
                    <svg class="shield-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path class="shield-path" d="M12 22C12 22 20 18 20 12V5L12 2L4 5V12C4 18 12 22 12 22Z" stroke="currentColor" stroke-width="1.5"/>
                        <path class="checkmark-path" d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h1 class="page-title">Добавление происшествия</h1>
            </div>
            <div class="header-actions">
                <a href="index.html" class="back-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M15 10H5M5 10L10 15M5 10L10 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Вернуться к списку</span>
                </a>
            </div>
        </header>
        <form class="incident-form" @submit.prevent="submitForm">
            <div class="form-section">
                <h2 class="section-title">Основная информация</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Тип происшествия</label>
                        <select v-model="form.type" required>
                            <option value="">Выберите тип</option>
                            <option v-for="type in incidentTypes" :value="type">{{ type }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Дата</label>
                        <input type="date" v-model="form.date" required>
                    </div>
                    <div class="form-group">
                        <label>Место происшествия</label>
                        <input type="text" v-model="form.location" placeholder="Укажите адрес" required>
                    </div>
                    <div class="form-group">
                        <label>Статус</label>
                        <select v-model="form.status" required>
                            <option value="">Выберите статус</option>
                            <option v-for="status in statuses" :value="status">{{ status }}</option>
                        </select>
                    </div>
                    <div class="form-group full-width">
                        <label>Описание происшествия</label>
                        <textarea v-model="form.description" rows="4" placeholder="Подробно опишите происшествие" required></textarea>
                    </div>
                </div>
            </div>
            <div class="form-section">
                <div class="section-header">
                    <h2 class="section-title">Причастные лица</h2>
                    <button type="button" class="add-btn" @click="addPerson">
                        <span>Добавить лицо</span>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
                <div v-for="(person, index) in form.involvedPersons" :key="index" class="person-card">
                    <div class="person-header">
                        <h3>Лицо #{{ index + 1 }}</h3>
                        <button type="button" class="remove-btn" @click="removePerson(index)">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M15 5L5 15M5 5L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ФИО</label>
                            <input type="text" v-model="person.fullName" placeholder="Полное имя" required>
                        </div>
                        <div class="form-group">
                            <label>Роль</label>
                            <select v-model="person.role" required>
                                <option value="">Выберите роль</option>
                                <option v-for="role in personRoles" :value="role">{{ role }}</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Адрес</label>
                            <input type="text" v-model="person.address" placeholder="Адрес проживания" required>
                        </div>
                        <div class="form-group">
                            <label>Судимости</label>
                            <input type="number" v-model="person.criminalRecord" min="0" placeholder="Количество судимостей">
                        </div>
                        <div class="form-group full-width">
                            <label>Примечания</label>
                            <textarea v-model="person.details" rows="2" placeholder="Дополнительная информация"></textarea>
                        </div>
                    </div>
                </div>
            </div>            <div class="form-actions">
                <button type="button" class="cancel-btn" @click="goBack">Отмена</button>
                <button type="submit" class="submit-btn">Сохранить</button>
            </div>
        </form>

        <!-- Алерт с продвинутой анимацией -->
        <transition name="alert">
            <div v-if="alert.show" class="alert-wrapper" @click.self="alert.show = false">
                <div class="alert-container" :class="alert.type">
                    <div class="alert-icon">
                        <svg v-if="alert.type === 'success'" viewBox="0 0 24 24" fill="none">
                            <path class="circle" d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                            <path class="check" d="M8 12L11 15L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <svg v-if="alert.type === 'error'" viewBox="0 0 24 24" fill="none">
                            <path class="circle" d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                            <path class="cross" d="M15 9L9 15M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="alert-content">
                        <h3 class="alert-title">{{ alert.title }}</h3>
                        <p class="alert-message">{{ alert.message }}</p>
                    </div>
                    <button class="alert-btn" @click="alert.show = false">
                        {{ alert.btnText || 'OK' }}
                    </button>
                </div>
            </div>
        </transition>
    </div>
    <script src="../script/add-incident.js"></script>
</body>
</html>